{% load profile_extra %}
<button 
    x-data="{ hasFollowed: {{ profile|has_followed:request.user|yesno:'true,false' }} }"
    type="button"
    class="nav-btn holo-glow group relative overflow-hidden
           px-3 py-2 sm:px-4 sm:py-3 lg:px-6 lg:py-4
           text-xs sm:text-sm font-bold tracking-wide
           rounded-lg border transition-all duration-300 ease-out
           backdrop-blur-15 cursor-pointer select-none
           min-w-[80px] sm:min-w-[100px] lg:min-w-[120px]"
    :class="hasFollowed 
      ? 'nav-btn-logout border-red-400/50 bg-gradient-to-r from-red-400/20 to-pink-500/20 text-red-300 hover:border-red-400/80 hover:from-red-400/30 hover:to-pink-500/30 hover:shadow-lg hover:shadow-red-400/30' 
      : 'nav-btn-secondary border-emerald-400/50 bg-gradient-to-r from-emerald-400/20 to-cyan-500/20 text-emerald-300 hover:border-emerald-400/80 hover:from-emerald-400/30 hover:to-cyan-500/30 hover:shadow-lg hover:shadow-emerald-400/30'"
    x-ref="followBtn"
    {% if request.user.is_authenticated %}
      @click="
        if (!hasFollowed) {
          $refs.followBtn.classList.add('holo-pulse');
          setTimeout(() => $refs.followBtn.classList.remove('holo-pulse'), 600);
        }
        hasFollowed = !hasFollowed
      "
      hx-post="{% url 'follow' profile.username %}"
      hx-swap="none"
      @follow-success="displayAlertMessage($event)"
    {% else %}
      @click="window.location.href = '{% url 'account_login' %}'"
    {% endif %}
    @mouseover="$refs.actionText.innerHTML = hasFollowed ? '✖ Unfollow' : '+ Follow'"
    @mouseleave="$refs.actionText.innerHTML = hasFollowed ? '✓ Following' : '+ Follow'"
    style="font-family: 'Press Start 2P', monospace; font-size: 8px;">
    
    <!-- Holographic Shine Effect -->
    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent 
                transform -skew-x-12 -translate-x-full group-hover:translate-x-full 
                transition-transform duration-700"></div>
    
    <!-- Button Text -->
    <span x-ref="actionText" 
          x-text="hasFollowed ? '✓ Following' : '+ Follow'" 
          class="relative z-10 transition-all duration-300"></span>
    
    <!-- Status Indicator -->
    <div class="absolute -top-1 -right-1 w-3 h-3 rounded-full transition-all duration-300"
         :class="hasFollowed ? 'bg-red-400 animate-pulse' : 'bg-emerald-400 animate-bounce'"
         style="animation-delay: 0.2s;"></div>
</button>



<style>
  /* Holographic Pulse Effect */
  .holo-pulse {
    animation: holoPulse 0.6s ease-out;
  }

  @keyframes holoPulse {
    0% {
      box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.8);
      transform: scale(1);
    }
    50% {
      box-shadow: 0 0 0 10px rgba(16, 185, 129, 0.4);
      transform: scale(1.05);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
      transform: scale(1);
    }
  }
</style>
